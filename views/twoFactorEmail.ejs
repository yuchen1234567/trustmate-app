<%- include('partials/navbar') %>

<div class="twofa-container">
    <div class="twofa-card">
        <p class="twofa-eyebrow">For Log In Page / 2FA</p>
        <h2>Verify Your Email</h2>
        <p class="twofa-subtext">
            For security reasons, please enter the one-time code sent to your registered email
            <span class="twofa-highlight"><%= maskedEmail %></span>.
        </p>

        <% if (error) { %>
            <div class="error-message"><%= error %></div>
        <% } %>
        <% if (typeof success !== 'undefined' && success) { %>
            <div class="success-message"><%= success %></div>
        <% } %>
        <% if (otpHint) { %>
            <p class="twofa-hint">Demo code: <strong><%= otpHint %></strong></p>
        <% } %>

        <form action="/2fa/email/verify" method="POST" class="twofa-form" data-otp-form>
            <div class="otp-inputs" data-otp-inputs>
                <input type="text" name="code1" inputmode="numeric" maxlength="1" class="otp-input" autocomplete="one-time-code" required>
                <input type="text" name="code2" inputmode="numeric" maxlength="1" class="otp-input" required>
                <input type="text" name="code3" inputmode="numeric" maxlength="1" class="otp-input" required>
                <input type="text" name="code4" inputmode="numeric" maxlength="1" class="otp-input" required>
                <input type="text" name="code5" inputmode="numeric" maxlength="1" class="otp-input" required>
                <input type="text" name="code6" inputmode="numeric" maxlength="1" class="otp-input" required>
            </div>
            <input type="hidden" name="code" data-otp-code>

            <button type="submit" class="btn-primary">Verify</button>
        </form>

        <a class="twofa-resend" href="/2fa/email/resend">Resend OTP</a>
    </div>
</div>

<script src="/js/otp.js"></script>
<%- include('partials/footer') %>
